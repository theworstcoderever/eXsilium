<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>2019迎新春游园活动</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <link rel="icon" href="../eXsilium/lib/src/favicon.png">
    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="../eXsilium/lib/CSS/main.css">
    <link rel="stylesheet" href="../eXsilium/lib/CSS/animate.css">
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
</head>
<body>
    <div id="app">
        <v-app>
            <v-content>
                <v-img src="http://wx2.sinaimg.cn/large/aa3282acgy1fzl9kh4q8zj21hc0u0qv5.jpg" height="900">
                    <v-container fluid fill-height>
                        <v-layout align-center justify-center>
                            <v-flex lg6 xs12 sm8 md4>
                                <transition enter-active-class="animated zoomIn" leave-active-class="animated zoomOut">
                                <v-card class="elevation-24" width="800" height="400" v-show="isLotteryShown">
                                    <v-toolbar dark color="pink lighten-2">
                                        <v-toolbar-title>2019新春抽奖</v-toolbar-title>
                                    </v-toolbar>
                                    <v-card-text>
                                    <v-layout align-center justify-center>
                                        <v-flex xs12 sm8 md9>
                                        <v-form>
                                            <v-text-field readonly label="获奖者" prepend-icon="person" v-model="prizedPerson" class="headline"></v-text-field>
                                            <v-text-field v-if="prizeItem == '三等奖'" readonly label="获奖者" prepend-icon="person" v-model="prizedPersonTwo" class="headline"></v-text-field>
                                            <v-select label="奖项" prepend-icon="menu" :items="prizeItems" v-model="prizeItem"></v-select>
                                        </v-form>
                                        </v-flex>
                                    </v-layout>
                                    </v-card-text>
                                    <v-card-actions>
                                        <v-spacer></v-spacer>
                                        <v-btn dark color="pink lighten-2" @click="startLottery()">{{ btnText }}</v-btn>
                                        <v-dialog v-model="dialog" width="550">
                                                <v-card class="text-lg-center">
                                                    <v-layout align-center justify-center>
                                                        <v-flex lg2 xs12 sm8 md9>
                                                            <v-img src="http://www.17sucai.com/preview/26528/2016-02-24/cj/images/gx.png" width="100"></v-img>  
                                                        </v-flex>
                                                    </v-layout>
                                                    <v-card-text v-if="prizeItem == '三等奖'" class="display-1" class="font-weight-bold">恭喜{{ prizedPerson }}、{{ prizedPersonTwo }}获得{{ prizeItem }}！</v-card-text>
                                                    <v-card-text v-else="prizeItem == '三等奖'" class="display-1" class="font-weight-bold">恭喜{{ prizedPerson }}获得{{ prizeItem }}！</v-card-text>           
                                                    <v-divider></v-divider>
                                                     <v-card-actions>
                                                         <v-spacer></v-spacer>
                                                       <v-btn v-model="isPrizeTaken" color="pink lighten-2" dark @click="dialog = false">颁奖</v-btn>
                                                    </v-card-actions>                                               
                                                </v-card>
                                        </v-dialog>
                                    <v-spacer></v-spacer>
                                    </v-card-actions>
                                </v-card>
                            </transition>
                            </v-flex>
                        </v-layout>

                        <div class="fab">
                            <v-speed-dial open-on-hover slide-y-reverse>
                                <v-btn slot="activator" fab dark medium color="pink" @click="showLottery">抽奖</v-btn>
                                <v-btn fab dark small color="red" @click="showScore">计分表</v-btn>
                            </v-speed-dial>
                        </div>
                    </v-container>
                </v-img>
                <v-footer app color="red lighten-1" dark absolute>
                    <v-spacer></v-spacer>
                    powered by [ʃ]inkai/进阶
                </v-footer>
            </v-content>
        </v-app>
    </div>
</body>
<script>
var vm = new Vue({
    el: '#app',
    data: {
        isLotteryShown: false,
        dialog: false,
        isPrizeTaken: false,
        prizeItem: "",
        prizeItems: ["一等奖","二等奖","三等奖"],
        prizedPerson: "大吉大利，必夺头筹！",
        prizedPersonTwo: "春节快乐！",
        personArray: [
            "郑源","李继平","秦潇","刘兴","邵强","段勇","徐大全","张平","徐友良","刘忠辉","李小勇","景恒","侯文义","代威建","李岱恩","范磊","宋阳",
            "谢世昌","夏大雨","杨建","李享", "毛小虎", "詹栩", "胡春林", "周永强", "钟均亮", "骆易杉", "郑鲍", "何昊", "叶翔", "龚杰", "谢婧婉", 
            "杨溢", "曾小兰", "杨莹", "刘丹", "聂虹", "邓学勇", "吕铁成", "邹元", "王一男", "刘翔", "李磊", "韩敏", "谢兴富", "王忠", "宋欢", "黄凯",
            "贾伟", "曹立强", "罗荣莉", "罗霁", "李丽", "熊汝奇", "陈志", "庞家彬", "杨小波", "廖舜", "陈晓禹", "唐伟", "陈涛", "董建伟", "李剑",
            "张科", "李丽媛", "汪洋", "彭凌燕", "张雪梅", "吴昊天", "代英俊", "缪双育", "徐亮", "唐安君", "朱艳春", "朱爱平", "余湖珂", "代兴宇", 
            "宗永", "王坚", "唐劲", "张戈", "刘小华", "姚雪康", "唐险峰", "王鹏", "马勇", "蒋枝", "蒲运翔", "李长生", "江晓龙", "梅玉芳", "邹静", 
            "朱丽艳", "郭玲玲", "高跃俐", "杨蒙薇", "邹平", "单联国", "何大海", "陈利", "张世强", "刘世明", "杨尹松", "王振涛", "付嘉丽", "李峰", 
            "朱健", "罗洪伟", "何勇", "邓荣礼", "陈兵", "冷秋林", "李涛", "李健", "刘小双", "高月明", "彭刚", "周鹏", "郭杨", "贺铁成", "李富勋",
            "潘恩", "陈松", "胡红", "曾凡林", "袁东", "陈容", "杨庆", "张宇", "梅润豪", "代金云", "张敬", "田德均", "张利涛", "徐劲波", "何家华",
            "蒋道忠", "彭静松", "肖经", "陈梦觉", "毛智强", "钟林", "代国平", "曾勇", "郝兵", "谭成钢", "饶军", "李超", "梁泉", "彭文杰", "黄震宇",
            "熊俊峰", "叶振中", "李强", "俞统绪", "胡宇", "黄伟", "黄玉希", "刘成金", "刘强", "王敏", "陈世翔", "李林", "高礼恒", "刘丹丹", 
            "李小红", "胡芳芳", "宋洁", "邹勇", "王健华", "陈军", "唐靖", "刘梅", "李叶", "田沈凡", "邓刚", "王碧成", "文珺", "郑德江", 
            "李传波", "叶宇峰", "潘侯杰", "罗哲伦", "刘亚", "景恒", "丁冬冬", "周大均", "朱超", "刘向德", "王国斌", "舒斌", "林云超", "文小军", 
            "陈吉彬", "郭超", "钟鹏", "谢罗", "付俊宇", "何骏马", "方鑫浩", "杨红", "冉贵虎", "熊心", "李强", "刘小龙", "谢劲科", "袁明江", "侯文义", 
            "代威建", "宋阳", "范磊", "李岱恩", "余建平", "付刚", "缪旭东", "潘建", "周熙", "王念", "汤召祥", "王超", "袁浩", "郑星", "荣杰", "李鹏飞",
            "李勇", "张胜全", "秦建", "吴康", "游欢", "任一夫", "黄永奎", "宋权伍", "龙雨", "王杰", "冷建", "胡云华", "黄博勋", "印声扬", "郑雷", 
            "陈飞", "张俊波", "李平", "王超(车)", "彭 勇", "黄 涛", "万刚毅", "肖祖斌", "邹家富", "吴基勇", "舒杰", "雷永强", "缪 军", "付立冬", 
            "陈兴知", "游浩洁", "杨军", "何绍伟", "周瑾颐", "黄自涛", "张勇", "赵金华", "陈凯", "王建军", "喻山", "甘利明", "钟 毅", "王麒", "缪建伟", 
            "王波", "张杰", "李川", "方震", "高兰华", "周文博", "缪建斌", "倪英", "孙怀林", "詹建松", "胡生平", "钟淑华", "周英", "肖鸣放", "刘盛乐", 
            "雷开宏", 
        ],
        pCount: 284,
        quota: 20, //名额
        isRunning: false,
        num: 0,
        numTwo: 0,
        btnText: "开始抽奖",
        time: 0
    },
    methods: {
        showLottery: function(){
            this.isLotteryShown = ! this.isLotteryShown;
        },
        showScore: function(){
            window.open("../eXsilium/score.html")
        },
        startLottery: function(){
            if(this.isRunning){
                this.isRunning = false;
                this.btnText = "开始抽奖";
                this.stopNum();
                this.affirmPrize();
                this.dialog = ! this.dialog;
            }else{
                this.isRunning = true;
                this.btnText = "停止抽奖";
                this.startNum();
            }
        },

        startNum: function(){
            this.num = Math.floor(Math.random() * this.pCount);
            if(this.prizeItem == "三等奖"){
                this.numTwo = Math.floor(Math.random() * this.pCount);
                //当一号和二号相等时重新取二号
                while(this.num == this.numTwo){
                    this.numTwo = Math.floor(Math.random() * this.pCount);
                }
                this.prizedPersonTwo = this.personArray[this.numTwo];
            }
            this.prizedPerson = this.personArray[this.num]; 
            this.time = setTimeout(this.startNum, 0);
        },
        stopNum: function(){
            this.pCount = this.personArray.length - 1;
            clearInterval(this.time);
            this.time = 0;
        },

        affirmPrize: function(){
            if(this.quota <= 0){
                this.$alert("提示", "抽奖已经结束!", {confirmButtonText: "确定"})
            }else{
                if(this.prizeItem == "三等奖"){
                    this.$notify({
                    title: "恭喜！",
                    message: "恭喜" + this.prizedPerson + "、" + this.prizedPersonTwo + "获得" +this.prizeItem,
                    duration: 5000
                })   
                }else{
                this.$notify({
                title: "恭喜！",
                message: "恭喜" + this.prizedPerson + "获得" +this.prizeItem,
                duration: 5000
                })
                };
                if(this.prizeItem == "三等奖"){
                    this.personArray.splice(this.numTwo,1);
                }
                this.personArray.splice(this.num,1);
            };
            this.quota = this.quota - 1;
        }
    },
})
</script>
</html>
